services:
  nacos:
    image: hyperagi/nacos-client:last
    environment:
      - PUBLIC_IP=${PUBLIC_IP}
      - NODE=${NODE}
      - PORT=8881
      - WALLET_ADDRESS=${WALLET_ADDRESS}
      - SERVICE_NAME=cogito:32b
    restart: always
  ollama:
    network_mode: host
    image: ollama/ollama
    ports:
      - '11434:11434'
    restart: always
    entrypoint: ['/bin/sh', '-c']
    runtime: nvidia
    command:
      - |
        ollama serve &
        sleep 5
        ollama pull cogito:32b
        ollama pull mxbai-embed-large
        wait
    volumes:
      - ./models:/root/.ollama/models
    environment:
      - OLLAMA_DEBUG=true
      - OLLAMA_LOG_LEVEL=trace
      - OLLAMA_VERBOSE=true
      - OLLAMA_KEEP_ALIVE=-1
      - OLLAMA_CONTEXT_LENGTH=8192
      - OLLAMA_NUM_PARALLEL=1
  hyper-agent-server:
    network_mode: host
    image: hyperagi/hyper-agent-server
    ports:
      - '8881:8881'
    restart: unless-stopped
    environment:
      - ES_URI=http://es.hyperagi.network
      - MODEL_NAME=cogito:32b
      - OLLAMA_BASE_URL=http://127.0.0.1:11434
      - MCP_SERVER=http://mcp-server.hyperagi.network
      - HYPER_AGI_API=https://app.hyperagi.network/api
      - UNIFAI_COMMAND=/usr/local/bin/npx
      - UNIFAI_AGENT_API_KEY=0Y6qBMnYVHwqa6K5w2WyjPLo7nCbb8KMlEfzATbyhib
      - UNIFAI_STATIC_TOOLKITS=68,7,3,4,11,10,39
  easytier:
    image: easytier/easytier:latest
    hostname: easytier
    container_name: easytier
    labels:
      com.centurylinklabs.watchtower.enable: 'true'
    restart: unless-stopped
    network_mode: host
    cap_add:
      - NET_ADMIN
      - NET_RAW
    environment:
      - TZ=Asia/Shanghai
    devices:
      - /dev/net/tun:/dev/net/tun
    volumes:
      - ./easytier:/root
      - ./machine-id:/etc/machine-id:ro
    command: -d --network-name mossai --network-secret mossai@2868 -p tcp://easytier.hyperagi.network:11010
